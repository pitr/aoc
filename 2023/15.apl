H ← (256|17×+)/∘⌽0,⎕UCS
N C ← ⍬⍬
⎕← +/{
    '-'∊⍵: H⍵⊣C/⍨←N/⍨←m←N≢¨⊂¯1↓⍵
    n ← ⊂¯2↓⍵
    n∊N: H⍵⊣C[N⍳n]←⍎⊃⌽⍵
    H⍵ ⊣ N,←n ⊣ C,←⍎⊃⌽⍵
}¨','(≠⊆⊢)⊃⊃⎕NGET'in/15.txt'1

⎕← +/C{(⍺+1)+.×(⍵×1+⍳≢⍵)}⌸⍨H¨N
