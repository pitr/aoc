f ← ','(≠⊆⊢)⊃⊃⎕NGET'in/15.txt'1
H ← (256|17×+)/∘⌽0,⎕UCS
ns ← cs ← ⍬
⎕←+/{
    '-'∊⍵: H⍵⊣cs/⍨←ns/⍨←m←ns≢¨⊂¯1↓⍵
    n c←'='(≠⊆⊢)⍵
    (⊂n)∊ns: H⍵⊣cs[ns⍳⊂n]←⍎c
    ns,←⊂n ⋄ cs,←⍎c
    H⍵
}¨f

⎕← +/cs{(⍺+1)+.×(⍵×1+⍳≢⍵)}⌸⍨H¨ns
