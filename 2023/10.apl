w ← ⊃⌽⍴M ← ↑⊃⎕NGET'in/10.txt'1
G ← ,⍬(x,x×w)(1,-w)(-1w)(1w)(¯1w)(x×w)(x←1 ¯1)['.SLJF7|-'⍳M]
G+← i←⍳≢G

⎕← .5×≢p ← { ⍵≡⍬:⍺ ⋄ (⍺,nxt)∇nxt←∪(∊G[⍵])~⍺ }⍨ ⍸∊M='S'
⎕← ≢p~⍨⍸∊2|+\(M∊'J|L')∧(⍴M)⍴i∊p
