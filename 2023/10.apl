w ← ⊃⌽⍴M ← ↑⊃⎕NGET'in/10.txt'1
G ← ⍬(1,-w)(-1w)(1w)(¯1w)(x×w)(x)(x,w×x←1 ¯1)[,'.LJF7|-S'⍳M]
G ← (≢G)⌊0⌈G+i←⍳≢G

⎕← .5×≢p ← { ⍵≡⍬:⍺ ⋄ (⍺,nxt)∇nxt←∪(∊G[⍵])~⍺ }⍨ ⍸∊M='S'
⎕← ≢p~⍨⍸∊2|+\(M∊'J|L')∧(⍴M)⍴i∊p
