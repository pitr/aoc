m ← '.'≠↑⊃⎕NGET'in/11.txt'1

⎕← +/, {m×(1+4×⍵)>{+/,⍵}⌺3 3⊢⍵}⍣≡2=m

⍝ connectivity matrix, c[x;]~0 are seats x is connected to
c ← 0⍪↑{(1↓¨↓⍵)[⍋⍵]}⊃,⌸/↓{⍵,⊖⍵}⍉↑⊃,/⊃,/({(+/⍵)(-/⍵)(⊣/⍵)(⊢/⍵)}↑i){⊂2,/⍵}⌸¨⊂1+⍳≢i←⍸m
⎕← +/{(1+4×⍵)>1↓+/(0,⍵)[c]}⍣≡(≢i)/0
