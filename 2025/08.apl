n ← ⍎¨⊃⎕NGET'in/08.txt'1
c ← ∪{⍵[⍋⍵]}¨(≢n)↓d{⍵[⍋⍺]}⍥,⍳⍴d←∘.(+.×⍨-)⍨n
p ← ⍳≢n   ⋄   e ← 10*⌊10⍟≢n

{   p∘← {p[⍵]}⍣≡p⊣{p[⍺]←⍵}/p[⍵⊃c]
    e=⍵+1: ∇⍵+1⊣⎕←×/3↑{⍵[⍒⍵]}{≢⍵}⌸p
    1=≢∪p: ⎕←×/⊃¨n[⍵⊃c]
    ∇⍵+1
} 0
