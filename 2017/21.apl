a _ b ← ↓⍉↑' '('.#'∘⍳¨≠⊆⊢)¨('/'⎕R'')⊃⎕NGET'in/21.txt'1
two ← 4=≢¨a
a ← {2(⊥∘,)¨∪(⊢,⌽¨)(⊢,⊖¨)(⊢,⍉¨)⊂(2/2+9=≢⍵)⍴⍵}¨a
b ← {(2/3+16=≢⍵)⍴⍵}¨b
a2 ← (two)/a ⋄ a3 ← (~two)/a
b2 ← (two)/b ⋄ b3 ← (~two)/b

run ← {
    s ← 2+2|≢⍵
    n ← (≢⍵)÷s
    c ← (2⊥,)¨⊂[2 3]0 2 1 3⍉n s n s⍴⍵
    2=s: ⊃⍪/,/b2[{1⍳⍨⍵∊¨a2}¨c]
    3=s: ⊃⍪/,/b3[{1⍳⍨⍵∊¨a3}¨c]
}

start ← 2 2 2⊤1 5 3
⎕← +/,run⍣5 ⊢start
⎕← +/,run⍣18⊢start
