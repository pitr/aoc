step ← {⊃⊃{(⌽@(256|⍵[1]+⍳⍺)⊃⍵)(+/⍺,1↓⍵)(1+2⊃⍵)}/(⌽⍵),⊂(⍳256)0 0}
knot ← {,⍉≠/2⊥⍣¯1⊢16 16⍴ step∊64/⊂(⎕UCS ⍵),17 31 73 47 23}

map ← ↑(⍳128){knot ⍵,'-',⍕⍺}¨⊃⎕NGET'in/14.txt'1

⎕← n←+/∊map

nei ← ,1∊¨⍳3 3
graph ← , {0=⍵[1;1]:⊂⍬ ⋄ ⊂1↓⍸⍣¯1⊢(nei/,⍵)~0}⌺3 3⊢(1+⍳n)@(⍸map)⊢map
⎕← ≢∪ ∨.∧⍨⍣≡ ↑graph~⊂⍬
