G ← ↑⊃⎕NGET'in/12.txt'1

a ← ,G{(G=⍺)/¨⍵}⍥(⊢,¨{⊂(,⍵)/⍨9⍴⍳2}⌺3 3) (⍴G)⍴p←⍳⍴,G
p ← {p[⍵]}⍣≡p⊣ 2{p[⍵]←⍺}⍥({p[⍵]}⍣≡)/¨a

C ← (3 0 1)(1 2 5)(5 8 7)(7 6 3)
area ← {≢⍵}⌸p
peri ← p{+/⍵}⌸5-≢¨a
side ← p{+/⍵}⌸,{+/0 2 5∊⍨2⊥¨⍵[1;1]=C{⍵[⍺]}¨⊂,⍵}⌺3 3⊢(⍴G)⍴1+p

⎕← area+.×peri
⎕← area+.×side
